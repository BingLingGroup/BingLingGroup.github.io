<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"binglinggroup.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":"default","style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="冰灵制作组的日志集散地">
<meta property="og:type" content="blog">
<meta property="og:title" content="冰灵的博客 | BingLing&#39;s Blog">
<meta property="og:url" content="https://binglinggroup.github.io/page/11/index.html">
<meta property="og:site_name" content="冰灵的博客 | BingLing&#39;s Blog">
<meta property="og:description" content="冰灵制作组的日志集散地">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="冰灵">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://binglinggroup.github.io/page/11/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/11/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>冰灵的博客 | BingLing's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">冰灵的博客 | BingLing's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <img class="custom-logo-image" src="/images/favicon.png" alt="冰灵的博客 | BingLing's Blog">
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="冰灵"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">冰灵</p>
  <div class="site-description" itemprop="description">冰灵制作组的日志集散地</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">56</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">93</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/BingLingGroup" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;BingLingGroup" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://binglinggroup.github.io/archives/autosub%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97(windows%E5%8F%8Aubuntu).html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="冰灵">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冰灵的博客 | BingLing's Blog">
      <meta itemprop="description" content="冰灵制作组的日志集散地">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 冰灵的博客 | BingLing's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/archives/autosub%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97(windows%E5%8F%8Aubuntu).html" class="post-title-link" itemprop="url">autosub安装使用指南(windows及ubuntu)(200302)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-02-10 21:00:00" itemprop="dateCreated datePublished" datetime="2019-02-10T21:00:00Z">2019-02-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-23 04:48:38" itemprop="dateModified" datetime="2024-04-23T04:48:38Z">2024-04-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%BC%94%E7%A4%BA/" itemprop="url" rel="index"><span itemprop="name">演示</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/archives/autosub%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97(windows%E5%8F%8Aubuntu).html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="archives/autosub安装使用指南(windows及ubuntu).html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/BingLingGroup/BingLingGroup.github.io/img/autosub%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97(windows%E5%8F%8Aubuntu)/[Crappy%201080P]%20Code%20Lyoko%20S2E41_000859.164_0.png">题图来源(Code Lyoko E41的08分59秒位置)</a>将浏览器拉窄即可看到全图。<br>PC版网页左上角从上到下第二个图标是目录，请多用目录。<br>网页右下角按钮为返回顶部，请多用返回顶部来查看顶部目录。<br><strong>autosub-0.4.0及以上版本支持python3。本文部分内容已过时，且不会更新，新的安装使用指南详见<a target="_blank" rel="noopener" href="https://github.com/BingLingGroup/autosub/blob/dev/docs/README.zh-Hans.md">autosub&#x2F;README.zh-Hans.md at dev · BingLingGroup&#x2F;autosub</a>。</strong></p>
</blockquote>
<p><escape><font size=4>目录</font></escape></p>
<ol>
<li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li>
<li><a href="#windows-python2-7%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE">windows python2.7环境安装配置</a><ul>
<li>2.1 <a href="#%E6%B2%A1%E5%AE%89%E8%A3%85%E8%BF%87python">没安装过python</a></li>
<li>2.2 <a href="#%E5%AE%89%E8%A3%85%E8%BF%87python">安装过python</a></li>
</ul>
</li>
<li><a href="#ubuntu-python2-7%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE">ubuntu python2.7环境安装配置</a></li>
<li><a href="#%E5%AE%89%E8%A3%85pip">安装pip</a><ul>
<li>4.1 <a href="#pip%E5%AE%89%E8%A3%85%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">pip安装的注意事项</a></li>
</ul>
</li>
<li><a href="#%E5%AE%89%E8%A3%85ffmpeg">安装ffmpeg</a></li>
<li><a href="#windows%E4%BD%BF%E7%94%A8pip%E5%AE%89%E8%A3%85autosub">windows使用pip安装autosub</a></li>
<li><a href="#ubuntu%E4%BD%BF%E7%94%A8pip%E5%AE%89%E8%A3%85autosub">ubuntu使用pip安装autosub</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8autosub">使用autosub</a></li>
<li><a href="#%E4%B8%8D%E8%83%BD%E7%A8%B3%E5%AE%9A%E8%BF%9E%E6%8E%A5google%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98">不能稳定连接google服务器的网络问题</a></li>
<li><a href="#google%E8%A7%81%E4%BA%BA%E4%B8%8B%E8%8F%9C%E7%9A%84%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98">google<del>见人下菜</del>的网络问题</a></li>
<li><a href="#%E5%85%B6%E4%BB%96%E9%97%AE%E9%A2%98">其他问题</a></li>
<li><a href="#%E8%87%AA%E5%8A%A8%E7%BF%BB%E8%AF%91%E5%8A%9F%E8%83%BD">自动翻译功能</a></li>
<li><a href="#%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E4%BD%BF%E7%94%A8">图形界面使用</a></li>
<li><a href="#%E5%AD%97%E5%B9%95%E6%A0%BC%E5%BC%8F%E6%89%B9%E9%87%8F%E8%BD%AC%E6%8D%A2">字幕格式批量转换</a></li>
<li><a href="#%E9%99%84%E5%BD%95">附录</a></li>
</ol>
<ul>
<li>15.1 <a href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AD%A4%E5%A4%84%E4%B8%8D%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8windows%EF%BC%9F">为什么此处不推荐使用windows？</a></li>
<li>15.2 <a href="#2-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AD%A4%E5%A4%84%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8ubuntu%EF%BC%9F">为什么此处推荐使用ubuntu？</a></li>
<li>15.3 <a href="#3-%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8Bapt%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8%E4%B8%AD%E7%9A%84%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF%EF%BC%9F">如何查看apt包管理器中的软件信息？</a></li>
<li>15.4 <a href="#4-python3%E5%91%BD%E4%BB%A4%E7%9A%84%E5%88%87%E6%8D%A2%E6%96%B9%E6%B3%95">python3命令的切换方法</a></li>
<li>15.5 <a href="#5-%E8%BD%AF%E4%BB%B6%E7%9A%84%E9%BB%98%E8%AE%A4%E8%BE%93%E5%87%BA%E5%A4%84%E7%90%86%E9%80%BB%E8%BE%91%E9%97%AE%E9%A2%98">软件的默认输出处理逻辑问题</a></li>
<li>15.6 <a href="#6-%E6%8A%8Agoogle%E6%89%B9%E5%88%A4%E4%B8%80%E7%95%AA%E7%9A%84%E6%97%A0%E7%AB%AF%E8%81%94%E6%83%B3">把google批判一番的无端联想</a></li>
<li>15.7 <a href="#7-autosub-windows%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E7%96%91%E9%9A%BE%E8%A7%A3%E7%AD%94">autosub windows使用问题疑难解答</a></li>
<li>15.8 <a href="#8-autosub-api%E8%B0%83%E7%94%A8%E5%8F%8A%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%AB%E5%8E%9F%E7%90%86%E6%A6%82%E8%A7%88">autosub api调用及语音识别原理概览</a></li>
</ul>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p><a target="_blank" rel="noopener" href="https://github.com/agermanidis/autosub/blob/master/README.md">autosub的readme</a>简介的<a target="_blank" rel="noopener" href="https://translate.google.com/#view=home&op=translate&sl=en&tl=zh-CN&text=Autosub%20is%20a%20utility%20for%20automatic%20speech%20recognition%20and%20subtitle%20generation.%20It%20takes%20a%20video%20or%20an%20audio%20file%20as%20input%2C%20performs%20voice%20activity%20detection%20to%20find%20speech%20regions%2C%20makes%20parallel%20requests%20to%20google%20Web%20Speech%20API%20to%20generate%20transcriptions%20for%20those%20regions%2C%20(optionally)%20translates%20them%20to%20a%20different%20language%2C%20and%20finally%20saves%20the%20resulting%20subtitles%20to%20disk.%20It%20supports%20a%20variety%20of%20input%20and%20output%20languages%20(to%20see%20which%2C%20run%20the%20utility%20with%20the%20argument%20--list-languages)%20and%20can%20currently%20produce%20subtitles%20in%20either%20the%20SRT%20format%20or%20simple%20JSON.">google翻译</a></p>
<blockquote>
<p>Autosub是一种用于自动语音识别和字幕生成的实用程序。它将视频或音频文件作为输入，执行语音活动检测以查找语音区域，向google Web Speech API发出并行请求以生成这些区域的转录，（可选）将它们转换为其他语言，最后保存结果字幕到本地。它支持各种输入和输出语言（使用参数–list-languages运行程序可查看支持的语言），并且当前可以生成SRT格式或简单JSON的字幕。</p>
</blockquote>
<p>由于使用了google的语音识别API，<del>而且提供了免费使用的google语音识别API key</del>，可以说autosub使用的是目前普通人可接触到的顶级的语音识别API也不为过。</p>
<h3 id="windows-python2-7环境安装配置"><a href="#windows-python2-7环境安装配置" class="headerlink" title="windows python2.7环境安装配置"></a>windows python2.7环境安装配置</h3><p><a href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AD%A4%E5%A4%84%E4%B8%8D%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8windows%EF%BC%9F">[1]为什么此处不推荐使用windows？</a></p>
<h4 id="没安装过python"><a href="#没安装过python" class="headerlink" title="没安装过python"></a>没安装过python</h4><p>如果你的windows之前没有安装过python，直接到python官网上下载安装python2.7，注意安装时在customize python 2.7界面下划到最底下选择Add Python.exe to Path。</p>
<p><escape><div title="Add Python.exe to Path" align="middle"><img src="https://cloud.githubusercontent.com/assets/20913258/17700048/c3d84166-6389-11e6-9cda-2144e2c98ade.png" height="50%" width="50%"></div></escape><br><escape><div align="middle">Add Python.exe to Path</div></escape></p>
<p>也可以考虑使用windows第三方包管理器<a target="_blank" rel="noopener" href="https://chocolatey.org/docs/installation">chocolatey</a>安装python2.7。</p>
<p>安装好chocolatey之后，用管理员权限运行命令行或者Powershell(譬如Win+X调出快捷键菜单运行)，输入以下指令来安装python2.7。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install python2 -y</span><br></pre></td></tr></table></figure>

<p><a href="#%E5%AE%89%E8%A3%85pip">下一步：安装pip</a></p>
<h4 id="安装过python"><a href="#安装过python" class="headerlink" title="安装过python"></a>安装过python</h4><p>如果你的windows安装过python2.7且没安装过python3，那么可以忽略掉python2.7环境安装配置这一部分了。</p>
<p>如果你的windows安装过python3，且在种种原因之下不能卸载python3，那么你需要查看[windows python2与python3环境共存简易方法](windows python2与python3环境共存简易方法.html)。</p>
<p><a href="#%E5%AE%89%E8%A3%85pip">下一步：安装pip</a></p>
<h3 id="ubuntu-python2-7环境安装配置"><a href="#ubuntu-python2-7环境安装配置" class="headerlink" title="ubuntu python2.7环境安装配置"></a>ubuntu python2.7环境安装配置</h3><p><a href="#2-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AD%A4%E5%A4%84%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8ubuntu%EF%BC%9F">[2]为什么此处推荐使用ubuntu？</a></p>
<p>ubuntu的python2.7一般是自带的，你可以通过</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -V</span><br></pre></td></tr></table></figure>

<p>查看当前python版本(注意<strong>V</strong>是大写)，如果python没有安装，可以通过</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install python -y</span><br></pre></td></tr></table></figure>

<p>安装python2.7。<a href="#3-%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8Bapt%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8%E4%B8%AD%E7%9A%84%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF%EF%BC%9F">[3]如何查看apt包管理器中的软件信息？</a></p>
<p>如果已安装的python命令对应的是python3的版本，而python2.7已经安装，可以通过<a target="_blank" rel="noopener" href="https://blog.csdn.net/u013894834/article/details/75305752">update-alternatives</a>这个命令来切换python版本。</p>
<p>相关参考<a href="#4-python3%E5%91%BD%E4%BB%A4%E7%9A%84%E5%88%87%E6%8D%A2%E6%96%B9%E6%B3%95">[4]python3命令的切换方法</a></p>
<p>ubuntu下一般python命令用于使用python2.7，python3命令用于使用python3</p>
<h3 id="安装pip"><a href="#安装pip" class="headerlink" title="安装pip"></a>安装pip</h3><p>通过<a target="_blank" rel="noopener" href="https://pip.pypa.io/en/stable/installing/">pip官方文档</a>安装最新版即可。windows用户可以通过浏览器打开第一条指令中的那个链接，然后Ctrl-S另存为get-pip.py文件，在get-pip.py所在的文件夹打开命令行或者powershell，运行第二条指令即可。</p>
<h4 id="pip安装的注意事项"><a href="#pip安装的注意事项" class="headerlink" title="pip安装的注意事项"></a>pip安装的注意事项</h4><ul>
<li>运行上述指令时使用的是对应着python2.7版本的python指令</li>
<li>ubuntu用户也可以使用apt包管理器中的python-pip软件包进行安装</li>
<li>windows用户不建议使用chocolatey中的pip进行安装，版本过旧</li>
<li>如果遇到了任何安装问题，一般通过<a target="_blank" rel="noopener" href="https://pip.pypa.io/en/stable/installing/">pip官方文档</a>的方法重新安装pip都可以解决</li>
</ul>
<h3 id="安装ffmpeg"><a href="#安装ffmpeg" class="headerlink" title="安装ffmpeg"></a>安装ffmpeg</h3><p>windows建议使用<a target="_blank" rel="noopener" href="https://chocolatey.org/docs/installation">chocolatey</a>安装ffmpeg。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install ffmpeg -y</span><br></pre></td></tr></table></figure>

<p>ubuntu则使用apt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install ffmpeg -y</span><br></pre></td></tr></table></figure>

<h3 id="windows使用pip安装autosub"><a href="#windows使用pip安装autosub" class="headerlink" title="windows使用pip安装autosub"></a>windows使用pip安装autosub</h3><p>由于原版autosub部分代码没有考虑到windows的问题，所以需要安装特别的版本。</p>
<p>大家可以使用我fork的已经修改过源代码的可以在windows上安装使用的autosub的版本<a target="_blank" rel="noopener" href="https://github.com/BingLingGroup/autosub">BingLingGroup&#x2F;autosub</a>。</p>
<p>有两种安装方法，一种是点击刚才这个项目主页右侧Clone or download按钮，在弹出的菜单中选择Download ZIP。</p>
<p><escape><div title="Clone or download" align="middle"><img src="https://help.github.com/assets/images/help/repository/clone-repo-clone-url-button.png" height="50%" width="50%"></div></escape><br><escape><div align="middle">Clone or download</div></escape></p>
<p><escape><br></escape><br><escape><br></escape></p>
<p><escape><div title="Download ZIP" align="middle"><img src="https://help.github.com/assets/images/help/repository/https-url-clone.png" height="50%" width="50%"></div></escape><br><escape><div align="middle">Download ZIP</div></escape></p>
<p>然后解压该zip文件，切换到setup.py所在目录，然后运行这条命令。这句命令最后有一个”.”表示当前目录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install .</span><br></pre></td></tr></table></figure>

<p><a href="#%E4%BD%BF%E7%94%A8autosub">下一步：使用autosub</a><br><escape><br></escape><br><escape><br></escape></p>
<p>另一种是安装git，你可以使用<a target="_blank" rel="noopener" href="https://chocolatey.org/docs/installation">choco</a>来安装git</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install git -y</span><br></pre></td></tr></table></figure>

<p>然后使用下面这条指令进行安装，也就是<a target="_blank" rel="noopener" href="https://pip.pypa.io/en/stable/reference/pip_install/#vcs-support">pip的VCS功能</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install git+https://github.com/BingLingGroup/autosub.git@origin</span><br></pre></td></tr></table></figure>

<p>如果你对我修改的代码产生疑虑，可以自己根据<a target="_blank" rel="noopener" href="https://github.com/agermanidis/autosub/issues/31">Install AutoSub Step to Step in Windows with Translate subtitle #31</a>进行安装，我所作的改动基本上就是这个问题里提到的那些。</p>
<p>也可以查看仓库对应的autosub-0.4.0-alpha版的<a target="_blank" rel="noopener" href="https://github.com/BingLingGroup/autosub/blob/alpha/docs/CHANGELOG.zh-Hans.md#040-alpha---2019-02-17">更新日志</a>和<a target="_blank" rel="noopener" href="https://github.com/BingLingGroup/autosub/commits/origin">提交历史</a>。</p>
<p><a href="#%E4%BD%BF%E7%94%A8autosub">下一步：使用autosub</a></p>
<h3 id="ubuntu使用pip安装autosub"><a href="#ubuntu使用pip安装autosub" class="headerlink" title="ubuntu使用pip安装autosub"></a>ubuntu使用pip安装autosub</h3><p>ubuntu用户运行以下指令，从PyPI(Python Package Index也即Python软件包索引)中安装autosub 0.3.12版，虽然版本没有原作者仓库<a target="_blank" rel="noopener" href="https://github.com/agermanidis/autosub">agermanidis&#x2F;autosub</a>里的新，但是不影响使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install autosub</span><br></pre></td></tr></table></figure>

<p>或者安装git</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install git -y</span><br></pre></td></tr></table></figure>

<p>然后再通过<a target="_blank" rel="noopener" href="https://pip.pypa.io/en/stable/reference/pip_install/#vcs-support">pip的VCS功能</a>安装github仓库里的代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install git+https://github.com/agermanidis/autosub.git@master</span><br></pre></td></tr></table></figure>

<h3 id="使用autosub"><a href="#使用autosub" class="headerlink" title="使用autosub"></a>使用autosub</h3><p>在命令行界面输入autosub -h可以得知autosub的输入参数。由于目前软件未提供翻译api而只提供了语音识别api，所以在不提供-K选项的情况下，所有尝试翻译的参数输入，即-S和-D的参数不一致的情况下都会失败。</p>
<p>想了解自动翻译功能的可以跳转至<a href="#%E8%87%AA%E5%8A%A8%E7%BF%BB%E8%AF%91%E5%8A%9F%E8%83%BD">自动翻译功能</a>。</p>
<p>除此之外软件还有逻辑bug，所以建议输全-S和-D参数，格式类似以下这种</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">autosub -S zh-CN -D zh-CN [你的视频/音频文件名]</span><br></pre></td></tr></table></figure>

<p>新建记事本-复制粘贴该行命令-修改后缀名为.bat即可双击使用，需要观看错误输出时注意在末尾加上call cmd，或者在命令行中运行。</p>
<p><a href="#5-%E8%BD%AF%E4%BB%B6%E7%9A%84%E9%BB%98%E8%AE%A4%E8%BE%93%E5%87%BA%E5%A4%84%E7%90%86%E9%80%BB%E8%BE%91%E9%97%AE%E9%A2%98">[5]软件的默认输出处理逻辑问题</a></p>
<h3 id="不能稳定连接google服务器的网络问题"><a href="#不能稳定连接google服务器的网络问题" class="headerlink" title="不能稳定连接google服务器的网络问题"></a>不能稳定连接google服务器的网络问题</h3><p>首先最大的问题是网络问题，如果你使用的是无法连接到google服务器的网络，windows端你可能需要在命令行界面下输入以下两个指令，以改变当前命令行的http proxy。注意http proxy一般由本地软件提供，譬如<a target="_blank" rel="noopener" href="https://github.com/Fndroid/clash_for_windows_pkg">克莱士</a>，127.0.0.1指本地IP，冒号后面的是本地软件提供的http proxy端口。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set http_proxy=http://127.0.0.1:1080</span><br><span class="line">set https_proxy=https://127.0.0.1:1080</span><br></pre></td></tr></table></figure>

<p>ubuntu也需要类似的指令给终端上代理，只是你需要注意本地proxy软件是否提供http proxy功能，如果只提供socks5 proxy，你需要使用<a target="_blank" rel="noopener" href="https://blog.csdn.net/Jesse_Mx/article/details/52863204">polipo</a>将其转为http proxy然后使用。</p>
<p>然而你依然可能遇到如图所示的错误(Connection broken)，多是因为你的网络不够稳定导致的，原因大概是google speech api对网络比较挑剔。</p>
<p><escape><div title="Clone or download" align="middle"><img src="https://raw.githubusercontent.com/BingLingGroup/BingLingGroup.github.io/img/autosub%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97(windows%E5%8F%8Aubuntu)/autosub_network.png" height="80%" width="80%"></div></escape><br><escape><div align="middle">Clone or download</div></escape></p>
<p>遇到这种错误，你可能需要更换网络环境。通常来讲，将运行平台更换为可稳定连接至google服务器的云服务器会比更换proxy更加有效，具体方式参考<a href="#2-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AD%A4%E5%A4%84%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8ubuntu%EF%BC%9F">[2]为什么此处推荐使用ubuntu？</a></p>
<h3 id="google见人下菜的网络问题"><a href="#google见人下菜的网络问题" class="headerlink" title="google见人下菜的网络问题"></a>google<del>见人下菜</del>的网络问题</h3><p>简言之：</p>
<ul>
<li>目前版本(0.4.0及以下版本)的autosub不要用香港IP，-S zh-CN的参数，去识别普通话的语音，不然会按照粤语识别输出繁体粤语(yue-Hant-HK)，识别结果也是完全错误。可以使用香港IP识别en，不会有影响。至于其他亚洲地区的IP，暂时没有尝试，不知道会不会对zh-CN识别普通话这一情况产生影响</li>
<li>问题的具体分析参见<a href="#8-autosub-api%E8%B0%83%E7%94%A8%E5%8F%8A%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%AB%E5%8E%9F%E7%90%86%E6%A6%82%E8%A7%88">[8]autosub api调用及语音识别原理概览</a></li>
</ul>
<h3 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h3><p>如果你还遇到了一些问题，请先google错误代码，也可以参考<a href="#7-autosub-windows%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E7%96%91%E9%9A%BE%E8%A7%A3%E7%AD%94">[7]autosub windows使用问题疑难解答</a>。</p>
<h3 id="自动翻译功能"><a href="#自动翻译功能" class="headerlink" title="自动翻译功能"></a>自动翻译功能</h3><p>autosub并不自带免费google翻译API key，所以需要正常使用翻译功能，你可以考虑以下方法：</p>
<ul>
<li><p>使用在google上搜索可以白嫖的google翻译API key，用-K选项输入给autosub进行自动翻译</p>
</li>
<li><p>其他提供了<em>免费</em> 翻译API key的修改版autosub(<strong>免责声明</strong>，本文作者未尝试其有效性)：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/iWangJiaxiang/autosub/tree/master">iWangJiaxiang&#x2F;autosub</a></li>
</ul>
</li>
<li><p>关于辅助类字幕自动翻译校对工具，可以考虑<a target="_blank" rel="noopener" href="https://github.com/agermanidis/autosub/issues/31">issue 31教程</a>Translate your Subtitles那部分提到的<a target="_blank" rel="noopener" href="https://github.com/SubtitleEdit/subtitleedit/releases">Subtitle Edit</a></p>
</li>
<li><p>将视频上传至youtube，使用youtube-dl获取自动翻译字幕</p>
</li>
<li><p>付费使用google翻译API key</p>
</li>
</ul>
<p><a href="#%E4%BD%BF%E7%94%A8autosub">返回使用autosub</a></p>
<h3 id="图形界面使用"><a href="#图形界面使用" class="headerlink" title="图形界面使用"></a>图形界面使用</h3><p>嫌弃命令行界面的用户可以考虑一个GUI版本<a target="_blank" rel="noopener" href="https://github.com/raryelcostasouza/pyTranscriber">pyTranscriber</a>(**免责声明**，本文作者未尝试其有效性)</p>
<h3 id="字幕格式批量转换"><a href="#字幕格式批量转换" class="headerlink" title="字幕格式批量转换"></a>字幕格式批量转换</h3><p>请使用ffmpeg对字幕格式进行转换，也可以考虑该<a target="_blank" rel="noopener" href="https://github.com/Bourshevik0/subtitle_works/blob/master/youtube-dl%20batch/ffmpeg_vtt2srt.bat">windows批处理脚本</a>。和附录<a href="#2-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AD%A4%E5%A4%84%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8ubuntu%EF%BC%9F">[2]</a>所说的批处理使用方法类似，输入格式和输出格式均可修改，参考<a target="_blank" rel="noopener" href="https://trac.ffmpeg.org/wiki/HowToConvertSubtitleToASS">HowToConvertSubtitleToASS – FFmpeg</a>，<a target="_blank" rel="noopener" href="https://trac.ffmpeg.org/wiki/ExtractSubtitles">ExtractSubtitles – FFmpeg</a>。关于.sub等图形格式字幕的转换，建议使用<a target="_blank" rel="noopener" href="https://github.com/SubtitleEdit/subtitleedit/releases">Subtitle Edit</a>，校对起来更方便。</p>
<h3 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h3><h4 id="1-为什么此处不推荐使用windows？"><a href="#1-为什么此处不推荐使用windows？" class="headerlink" title="[1]为什么此处不推荐使用windows？"></a>[1]为什么此处不推荐使用windows？</h4><p><escape><div title="用错图了.jpg" align="middle"><img src="https://raw.githubusercontent.com/BingLingGroup/BingLingGroup.github.io/img/autosub安装使用指南(windows及ubuntu)/sticker_yczaebag.png" height="40%" width="40%"></div></escape><br><escape><div align="middle">ArchLinux使人笑颜倍增</div></escape></p>
<p><em>不推荐在windows下安装使用autosub</em>，除非</p>
<ul>
<li><em>首先，你有着可<strong>稳定</strong>连接google服务器的网络环境</em></li>
<li><em>其次，<strong>你自认为</strong>windows比ubuntu更方便使用，哪怕有的ubuntu甚至不需要额外安装python环境</em></li>
<li><em>再次，你需要容忍一些autosub代码中windows有问题而ubuntu没问题的部分，或者使用非原github仓库或者非PyPI上的autosub代码来解决问题</em></li>
</ul>
<p><a href="#windows-python2-7%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE">返回windows python2.7环境安装配置</a></p>
<h4 id="2-为什么此处推荐使用ubuntu？"><a href="#2-为什么此处推荐使用ubuntu？" class="headerlink" title="[2]为什么此处推荐使用ubuntu？"></a>[2]为什么此处推荐使用ubuntu？</h4><ul>
<li><p><em>如果你肉身能<strong>稳定</strong>连接google服务器，依然建议使用ubuntu操作，因为更容易安装使用python和autosub</em></p>
<ul>
<li><em>同时请忽略以下这段说明</em></li>
</ul>
</li>
<li><p><em>此处推荐的ubuntu环境一般为可<strong>稳定</strong>连接google服务器的ubuntu服务器</em></p>
<ul>
<li>*例如安装了ubuntu的虚拟专用服务器(<strong>V</strong>irtual <strong>P</strong>rivate <strong>S</strong>erver)或者弹性计算服务器(Elastic Compute Service)或者独立服务器(Dedicated Server)*</li>
<li><em>远程服务器一般不可安装windows，即使可选，ubuntu的服务器软件环境还是比windows高到不知道哪里去了</em></li>
<li><em>其他linux系统的使用此处略去</em></li>
</ul>
</li>
</ul>
<p>远程服务器操作指引：</p>
<ul>
<li>远程服务器ssh连接工具<a target="_blank" rel="noopener" href="https://blog.phpgao.com/cmder.html">cmder</a>(ssh连接命令<a target="_blank" rel="noopener" href="https://blog.phpgao.com/post_buy_faq.html"><em>如何登陆我的vps</em></a>)，xshell，MobaXterm等等</li>
<li>远程文件交互工具winscp(文件上传下载)，<a target="_blank" rel="noopener" href="https://imnerd.org/use-caddy-replace-nginx.html">caddy</a>(文件下载)，jQuery-File-Upload(文件上传)</li>
<li>ubuntu ssh配置，ubuntu ssh服务启动等等</li>
<li>建议上传时只上传音频文件，上传视频文件既耗时也占用服务器存储空间</li>
<li>以下是windows调用ffmpeg批量抽取当前文件夹下的视频的音频的批处理，新建记事本-复制粘贴代码-修改后缀名为.bat即可使用。由于autosub使用ffmpeg进音频转码，且无论什么音频或视频格式输入，都会转换为flac格式，所以此处音频输出采用非编码输出mka万能封装效率最高</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">set &quot;in_format=*.webm *.mp4&quot;</span><br><span class="line">rem 根据需要这里in_format修改为自己要输入的格式</span><br><span class="line">rem 注意不要去掉通配符*号</span><br><span class="line">rem 暂时不支持批量抽取一个视频中的多个音轨</span><br><span class="line">set &quot;out_format=.mka&quot;</span><br><span class="line">rem 此处输出格式不要修改，否则可能会输出失败</span><br><span class="line">rem 因为当前为非编码模式，只能使用mka这种万能封装</span><br><span class="line"></span><br><span class="line">@echo on</span><br><span class="line">for /f &quot;delims=^&quot; %%i in (&#x27;dir /b %in_format%&#x27;) do (</span><br><span class="line">    ffmpeg -i &quot;%%i&quot; -vn -acodec copy &quot;%%~ni%out_format%&quot;</span><br><span class="line">)</span><br><span class="line">@echo off</span><br><span class="line">rem 此处会将当前文件夹下的所有视频的音频进行抽取</span><br><span class="line">rem 文件名和原来的一致，扩展名为你设置的输出格式</span><br><span class="line"></span><br><span class="line">call cmd</span><br></pre></td></tr></table></figure>

<ul>
<li>如果安装了git bash或者其他可在windows下运行bash语言的终端，可以使用这个对格式有判断的bash脚本<a target="_blank" rel="noopener" href="https://askubuntu.com/questions/221026/how-can-i-batch-extract-audio-from-mp4-files-with-ffmpeg-without-decompression">bash - how can I batch extract audiofrom mp4 files with ffmpeg without decompression (automatic audio codec detection)? - Ask Ubuntu</a></li>
<li>ubuntu端批量识别音频的bash脚本${C\infty ming}$ ${S\infty n}^{TM}$</li>
</ul>
<p>以及一些估计没人会和我一样踩的坑：</p>
<ul>
<li>如果你使用的ubuntu服务器内存空闲空间小于150MB，可能会遇到内存不够用的问题，错误信息会显示内存空间不够，分配失败，请关闭部分后台程序后再运行autosub即可。内存占用主要是调用ffmpeg转码音频为flac格式时发生的。</li>
<li>虽然语音识别的任务是由google服务器进行，而音频分析时间轴生成的任务是在本地完成的，可以说识别速度的瓶颈基本不在本地，但是对于少数CPU特别弱的ubuntu服务器(点名批评半碗果20刀祖传OVZ架构单核服务器)，可能会遇到音频分析时间对CPU占用过大拖累识别速度的问题。我这里并不是建议你非得用多核服务器，我是说最好别碰OVZ架构。</li>
</ul>
<p><a href="#ubuntu-python2-7%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE">返回ubuntu python2.7环境安装配置</a></p>
<h4 id="3-如何查看apt包管理器中的软件信息？"><a href="#3-如何查看apt包管理器中的软件信息？" class="headerlink" title="[3]如何查看apt包管理器中的软件信息？"></a>[3]如何查看apt包管理器中的软件信息？</h4><p>Ubuntu apt包管理器中的python软件包目前版本依然是python2.7，可以通过</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-cache show package python</span><br></pre></td></tr></table></figure>

<p>查看python包的详情。</p>
<p><a href="#ubuntu-python2-7%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE">返回ubuntu python2.7环境安装配置</a></p>
<h4 id="4-python3命令的切换方法"><a href="#4-python3命令的切换方法" class="headerlink" title="[4]python3命令的切换方法"></a>[4]python3命令的切换方法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.x 1</span><br><span class="line">update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.y 2</span><br><span class="line">update-alternatives --config python3</span><br></pre></td></tr></table></figure>

<p>x和y代表某个python3的版本，以上方法来源<a target="_blank" rel="noopener" href="https://www.v2ex.com/t/429372#r_5389764">搞定了最新版本 EFB2.0.0， telegram 收发微信，工作正常。 - V2EX</a>。</p>
<p><a href="#ubuntu-python2-7%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE">返回ubuntu python2.7环境安装配置</a></p>
<h4 id="5-软件的默认输出处理逻辑问题"><a href="#5-软件的默认输出处理逻辑问题" class="headerlink" title="[5]软件的默认输出处理逻辑问题"></a>[5]软件的默认输出处理逻辑问题</h4><p><escape><div title="Error: Subtitle translation requires specified google Translate API key." align="middle"><img src="https://user-images.githubusercontent.com/8603085/38403193-cb5a5e04-398b-11e8-8472-3dd3a73455f7.png" height="100%" width="100%"></div></escape><br><escape><div align="middle">该逻辑问题的错误信息输出</div></escape></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">C:\&gt;autosub -h</span><br><span class="line">usage: autosub [-h] [-C CONCURRENCY] [-o OUTPUT] [-F FORMAT] [-S SRC_LANGUAGE]</span><br><span class="line">               [-D DST_LANGUAGE] [-K API_KEY] [--list-formats]</span><br><span class="line">               [--list-languages]</span><br><span class="line">               [source_path]</span><br><span class="line"></span><br><span class="line">positional arguments:</span><br><span class="line">  source_path           Path to the video or audio file to subtitle</span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  -h, --<span class="built_in">help</span>            show this <span class="built_in">help</span> message and <span class="built_in">exit</span></span><br><span class="line">  -C CONCURRENCY, --concurrency CONCURRENCY</span><br><span class="line">                        Number of concurrent API requests to make</span><br><span class="line">  -o OUTPUT, --output OUTPUT</span><br><span class="line">                        Output path <span class="keyword">for</span> subtitles (by default, subtitles are</span><br><span class="line">                        saved <span class="keyword">in</span> the same directory and name as the <span class="built_in">source</span></span><br><span class="line">                        path)</span><br><span class="line">  -F FORMAT, --format FORMAT</span><br><span class="line">                        Destination subtitle format</span><br><span class="line">  -S SRC_LANGUAGE, --src-language SRC_LANGUAGE</span><br><span class="line">                        Language spoken <span class="keyword">in</span> <span class="built_in">source</span> file</span><br><span class="line">  -D DST_LANGUAGE, --dst-language DST_LANGUAGE</span><br><span class="line">                        Desired language <span class="keyword">for</span> the subtitles</span><br><span class="line">  -K API_KEY, --api-key API_KEY</span><br><span class="line">                        The google Translate API key to be used. (Required <span class="keyword">for</span></span><br><span class="line">                        subtitle translation)</span><br><span class="line">  --list-formats        List all available subtitle formats</span><br><span class="line">  --list-languages      List all available <span class="built_in">source</span>/destination languages</span><br></pre></td></tr></table></figure>

<p>根据87号拉取请求<a target="_blank" rel="noopener" href="https://github.com/agermanidis/autosub/pull/87">Perform speech recognition if dst_language is not denied. #87</a>，在视频源语言(SRC_LANGUAGE)不是默认字幕文件目标语言(DEFAULT_DST_LANGUAGE)en时，软件逻辑会出现问题，认为你希望将语音识别请求由视频源语言翻译成默认字幕文件目标语言。</p>
<p>根据python的参数语法分析逻辑，如果你不给定某一参数的值，譬如-D参数的值，程序会使用默认值，默认值这里原作者使用的是给定的en，而不会根据-S的值变化，所以有悖一般用户的使用逻辑。</p>
<p><a href="#%E4%BD%BF%E7%94%A8autosub">返回使用autosub</a></p>
<h4 id="6-把google批判一番的无端联想"><a href="#6-把google批判一番的无端联想" class="headerlink" title="[6]把google批判一番的无端联想"></a>[6]把google批判一番的无端联想</h4><p>破案了，参考附录<a href="#8-autosub-api%E8%B0%83%E7%94%A8%E5%8F%8A%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%AB%E5%8E%9F%E7%90%86%E6%A6%82%E8%A7%88">[8]</a>，以下内容已过期。</p>
<p>这个问题就很玄学了，我尝试过en和zh-CN的语音识别，但是只在zh-CN的语音识别上遇到过。查看–list-languages参数可知，zh-CN指的是Chinese (Simplified)，zh-TW指的是Chinese (Traditional)，但是你如果使用香港的IP地址使用zh-CN的参数对语音进行识别，会识别出繁体粤语来，<del>这既不简体也不普通话啊，难道google想暗示在香港地区zh-CN里的CN指的其实是Cantonese？《震惊！404公司又一乳滑石锤》</del>，关键是autosub不给你一个香港地区识别<strong>普通话简体中文</strong>的参数(其实也不完全，看后文)，而且如果你拿普通话的音频当作粤语去识别，那结果肯定是没法对上号的。</p>
<p><del>而且实话讲只是支持粤语，又不是支持更加政治正确的吴语(<a target="_blank" rel="noopener" href="https://cloud.google.com/speech-to-text/docs/languages">没有吴语</a>)，显然也无法给google，用支持少数语言的名义洗地，这只是纯粹的商业化行为而已</del></p>
<p><del>暂时没试在香港地区使用zh-TW参数能否按照普通话Mandarin识别出繁体，这样至少我还能把文本复制到word里面繁体转简体，说明我对常凯申的疯狂转进流学习得还不够透彻</del></p>
<p>但是如果是使用美国的IP，那么zh-CN的识别结果就是很正常的，<del>google怎么会觉得法拉盛的高华用的是简体中文</del>。我之前看过代码，autosub没有对语言代码做过手脚，都是直接传给api了，<del>那只能说是google爸爸又<strong>不作恶</strong>了</del>，今且按不下表。</p>
<p>那么对于我们这些不能左右<del>根据你IP个性化推荐语音识别结果</del>这些大公司的普通<del>白嫖</del>用户来讲，只能从根子上入手，用美国IP就是了。<del>生是洛圣都的人，死是洛圣都的鬼。</del></p>
<p><del>再补充一下，我看了一下google speech api的文档，对于language code这一点而言已经有了新的标准<a target="_blank" rel="noopener" href="https://cloud.google.com/speech-to-text/docs/languages">语言支持 | Cloud Speech-to-Text API</a>。但是仍然很难解释，凭什么我给zh-CN的参数，google用我的IP，就给我转换成yue-Hant-HK了，要么你不给我转换报错也可以啊。不过我看了一下新版的api和autosub里面<a target="_blank" rel="noopener" href="https://github.com/agermanidis/autosub/blob/master/autosub/constants.py">constants.py</a>的区别，确实也有pull request的余地，等以后作进一步研究吧。</del></p>
<p>(当然我也没试验过除了香港以外亚洲地区zh-CN的识别结果如何，没钱啊)</p>
<h4 id="7-autosub-windows使用问题疑难解答"><a href="#7-autosub-windows使用问题疑难解答" class="headerlink" title="[7]autosub windows使用问题疑难解答"></a>[7]autosub windows使用问题疑难解答</h4><p><a target="_blank" rel="noopener" href="https://github.com/agermanidis/autosub/issues/94">Exception: Dependency not found: ffmpeg · Issue #94 · agermanidis&#x2F;autosub</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/agermanidis/autosub/issues/15">Temp Folder Permissions Denied on Windows 10 · Issue #15 · agermanidis&#x2F;autosub</a></p>
<p><a href="#%E5%85%B6%E4%BB%96%E9%97%AE%E9%A2%98">返回其他问题</a></p>
<h4 id="8-autosub-api调用及语音识别原理概览"><a href="#8-autosub-api调用及语音识别原理概览" class="headerlink" title="[8]autosub api调用及语音识别原理概览"></a>[8]autosub api调用及语音识别原理概览</h4><p>为了研究language code在autosub里面的使用情况，我开始查看autosub的源代码，研究了半天它这api的调用方法，也翻了一会issue区的问题，才发现我前面完全搞错了这个api的来源。首先根据issue区里面的<a target="_blank" rel="noopener" href="https://github.com/agermanidis/autosub/issues/1">your api key #1</a>开发者的回答，他这个api就是从chromium的源代码上面扒下来的，我发现这个api和cloud speech api其实没有太大关系，自然用法也不一样。具体情况可以参考这个回复<a target="_blank" rel="noopener" href="https://github.com/agermanidis/autosub/issues/111#issuecomment-463046630">api key Is it a charge item? #111</a>。我在google上搜到这么一个项目<a href="(https://github.com/gillesdemey/google-speech-v2)">google-speech-v2</a>，对这个api的使用提供了一点参考。我接下来有空会对修改后的代码进行测试，如果这个api能识别cloud speech api里面的语言代码，我会提交pull request对主项目进行改进。</p>
<p><a href="#google%E8%A7%81%E4%BA%BA%E4%B8%8B%E8%8F%9C%E7%9A%84%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98">返回google<del>见人下菜</del>的网络问题</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://binglinggroup.github.io/archives/windows%20python2%E4%B8%8Epython3%E7%8E%AF%E5%A2%83%E5%85%B1%E5%AD%98%E7%AE%80%E6%98%93%E6%96%B9%E6%B3%95.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="冰灵">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冰灵的博客 | BingLing's Blog">
      <meta itemprop="description" content="冰灵制作组的日志集散地">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 冰灵的博客 | BingLing's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/archives/windows%20python2%E4%B8%8Epython3%E7%8E%AF%E5%A2%83%E5%85%B1%E5%AD%98%E7%AE%80%E6%98%93%E6%96%B9%E6%B3%95.html" class="post-title-link" itemprop="url">windows python2与python3环境共存简易方法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-02-09 19:00:00" itemprop="dateCreated datePublished" datetime="2019-02-09T19:00:00Z">2019-02-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-23 04:48:32" itemprop="dateModified" datetime="2024-04-23T04:48:32Z">2024-04-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%BC%94%E7%A4%BA/" itemprop="url" rel="index"><span itemprop="name">演示</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/archives/windows%20python2%E4%B8%8Epython3%E7%8E%AF%E5%A2%83%E5%85%B1%E5%AD%98%E7%AE%80%E6%98%93%E6%96%B9%E6%B3%95.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="archives/windows python2与python3环境共存简易方法.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p><a target="_blank" rel="noopener" href="https://ws1.sinaimg.cn/large/b07fd0f8ly1g00hpgpvxpj21hc0u07wh.jpg">题图来源(Code Lyoko E81的13分55秒位置)</a>将浏览器拉窄即可看到全图。<br>PC版网页左上角从上到下第二个图标是目录，请多用目录。<br>网页右下角按钮为返回顶部，请多用返回顶部来查看顶部目录。</p>
</blockquote>
<p><escape><font size=4>目录</font></escape></p>
<ol>
<li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li>
<li><a href="#%E5%8E%9F%E7%90%86">原理</a></li>
<li><a href="#%E5%AE%89%E8%A3%85">安装</a></li>
<li><a href="#%E6%89%8B%E5%8A%A8%E8%AE%BE%E7%BD%AE%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">手动设置系统环境变量</a><ul>
<li>4.1 <a href="#%E9%80%9A%E8%BF%87%E7%B3%BB%E7%BB%9F%E5%B1%9E%E6%80%A7%E8%AE%BE%E7%BD%AE">通过系统属性设置</a><ul>
<li>4.1.1 <a href="#%E6%96%B0%E5%BB%BAPY-HOME%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F">新建PY_HOME系统变量</a></li>
<li>4.1.2 <a href="#%E5%B7%B2%E7%BB%8F%E6%9C%89Path%E8%BF%99%E4%B8%AA%E5%8F%98%E9%87%8F">已经有Path这个变量</a></li>
<li>4.1.3 <a href="#%E8%BF%98%E6%B2%A1%E6%9C%89Path%E8%BF%99%E4%B8%AA%E5%8F%98%E9%87%8F">还没有Path这个变量</a></li>
</ul>
</li>
<li>4.2 <a href="#%E9%80%9A%E8%BF%87%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%BF%9B%E8%A1%8C%E8%AE%BE%E7%BD%AE">通过注册表进行设置</a></li>
<li>4.3 <a href="#%E9%80%9A%E8%BF%87%E5%91%BD%E4%BB%A4%E8%A1%8Csetx%E5%91%BD%E4%BB%A4%E5%92%8Creg%E5%91%BD%E4%BB%A4%E8%BF%9B%E8%A1%8C%E8%AE%BE%E7%BD%AE">通过命令行setx命令和reg命令进行设置</a></li>
</ul>
</li>
<li><a href="#%E8%87%AA%E5%8A%A8%E8%AE%BE%E7%BD%AE%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">自动设置系统环境变量</a></li>
<li><a href="#%E9%80%9A%E8%BF%87PY-HOME%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%E5%88%87%E6%8D%A2python%E7%89%88%E6%9C%AC">通过PY_HOME系统变量切换python版本</a><ul>
<li>6.1 <a href="#%E6%89%8B%E5%8A%A8%E5%88%87%E6%8D%A2python%E7%89%88%E6%9C%AC">手动切换python版本</a></li>
<li>6.2 <a href="#%E8%87%AA%E5%8A%A8%E5%88%87%E6%8D%A2python%E7%89%88%E6%9C%AC">自动切换python版本</a></li>
</ul>
</li>
<li><a href="#%E6%9C%AC%E6%96%B9%E6%B3%95%E5%8F%82%E8%80%83">本方法参考</a></li>
</ol>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>该简易方法可以做到在windows下“同时”安装python2和python3环境依赖且使用互不兼容的python软件包(如vapoursynth和autosub)，不会涉及到Pycharm python开发环境设置，<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/22678445">anaconda</a>的配置设置等等。</p>
<p>此处所指的vapoursynth与autosub的冲突是指，vapoursynth必须要使用python3以上的python运行环境，autosub必须要使用python2的python运行环境，而python3环境会影响到autosub的使用。autosub的<a target="_blank" rel="noopener" href="https://github.com/agermanidis/autosub/issues/31">issue区的教程</a>给出的解决方法竟然是卸载python3，我只能说我卸不起卸不起，太暴力了.jpg</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">环境变量 - 维基百科</a><br><a target="_blank" rel="noopener" href="https://docs.python.org/3/using/windows.html">Using Python on Windows - Python 3.7.2 documentation</a><br>简言之就是通过设置环境变量特别是系统环境变量Path，可以让python及python相关的软件包在命令行的非python环境目录下正常运行。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>首先是安装Python27和Python37，你可以使用<a target="_blank" rel="noopener" href="https://chocolatey.org/docs/installation">chocolatey</a>安装python。</p>
<p>安装好chocolatey之后，用管理员权限运行命令行或者Powershell(譬如Win+X调出快捷键菜单运行)，输入以下指令来安装python27和python37。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">choco install python2 -y</span><br><span class="line">choco install python -y</span><br></pre></td></tr></table></figure>

<p>如果你使用的是python的安装包进行的安装，可以考虑在安装过程中选择自定义功能并勾选Add python.exe to Path，使用choco安装时将自动设置环境变量。</p>
<p>安装时注意尽量使用默认安装路径，否则在后文提到的安装路径处请修改为自己的安装路径。</p>
<h3 id="手动设置系统环境变量"><a href="#手动设置系统环境变量" class="headerlink" title="手动设置系统环境变量"></a>手动设置系统环境变量</h3><p>但是python环境共存并不仅仅只是安装完两个版本的python这么简单，想要正常使用，你可以借助官方提供的<a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/pep-0397/">Python launcher for Windows</a>以及具体使用方法<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/21653286">同时装了Python3和Python2，怎么用pip？ - 知乎</a>。</p>
<p>当然本篇文章所讲的并不是换个命令继续用的方法，<del>因为是我实践完了以后才发现的这个方法，不想再试了</del>，而是不需要改变原来的命令就可以直接用的方法。</p>
<blockquote>
<p>能用命令行做的事就不要用图形界面做</p>
</blockquote>
<p>这话反过来就是：</p>
<blockquote>
<p>图形界面能做的事就不要用命令行做</p>
</blockquote>
<p>以下将提到两种用GUI设置，两种用命令行设置系统环境变量的方法。</p>
<h4 id="通过系统属性设置"><a href="#通过系统属性设置" class="headerlink" title="通过系统属性设置"></a>通过系统属性设置</h4><p>此电脑(我的电脑)-右键-属性-高级-环境变量，在弹出的窗口中可以看到上半部分用户变量和下半部分系统变量，根据这篇教程<a target="_blank" rel="noopener" href="http://chenjiee815.github.io/pythonhuan-jing-bian-liang.html">Python环境变量</a>，如果你看到用户环境变量或者系统环境变量里面有<strong>PYTHONHOME</strong>这个变量，务必删掉，否则会影响我后面提到的切换的方法。(<strong>注意是变量，不是值，窗口里面有两列，第一列标的是变量，第二列是值</strong>)同时删除和python有关的用户变量或者系统变量。</p>
<p>因为python命令输入时，程序一旦读到<strong>PYTHONHOME</strong>这个变量，就会去找这个目录下的python，而忽略掉其他变量的设置。</p>
<h5 id="新建PY-HOME系统变量"><a href="#新建PY-HOME系统变量" class="headerlink" title="新建PY_HOME系统变量"></a>新建PY_HOME系统变量</h5><p>接下来点击新建(注意是系统变量的对话框，也就是下半部分对话框旁边的新建)，在弹出的窗口中的变量名框内输入<strong>PY_HOME</strong>，变量值输入你马上要用的Python.exe所在的路径，点确定来保存。</p>
<p>然后找到系统变量界面中的Path这个变量。</p>
<h5 id="已经有Path这个变量"><a href="#已经有Path这个变量" class="headerlink" title="已经有Path这个变量"></a>已经有Path这个变量</h5><p>选中Path变量，点击编辑，注意先删除已经存在的python的路径(如C:\Python27，C:\Python27\Scripts等)。</p>
<p>然后在弹出的窗口右侧点击新建，输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%PY_HOME%</span><br></pre></td></tr></table></figure>

<p>输完之后回车，再次重复以上步骤输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%PY_HOME%\Scripts</span><br></pre></td></tr></table></figure>

<p>然后点确定来保存。</p>
<p>如果觉得麻烦，也可以选择右侧的编辑文本，在最右侧或者最左侧添加，每一项之间用 <strong>;</strong> 分隔。</p>
<p><a href="#%E9%80%9A%E8%BF%87PY-HOME%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%E5%88%87%E6%8D%A2python%E7%89%88%E6%9C%AC">下一步：通过PY-HOME系统变量切换python版本</a></p>
<h5 id="还没有Path这个变量"><a href="#还没有Path这个变量" class="headerlink" title="还没有Path这个变量"></a>还没有Path这个变量</h5><p>点击新建(注意是系统变量，也就是下半部分对话框旁边的新建)，在弹出的窗口中的变量名框内输入<strong>Path</strong>，变量值输入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%PY_HOME%;%PY_HOME%\Scripts;</span><br></pre></td></tr></table></figure>

<p>然后点确定来保存。</p>
<p><a href="#%E9%80%9A%E8%BF%87PY-HOME%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%E5%88%87%E6%8D%A2python%E7%89%88%E6%9C%AC">下一步：通过PY-HOME系统变量切换python版本</a></p>
<h4 id="通过注册表进行设置"><a href="#通过注册表进行设置" class="headerlink" title="通过注册表进行设置"></a>通过注册表进行设置</h4><p>通过Win+R键调出运行，输入regedit打开注册表编辑器，在上方路径框中输入</p>
<blockquote>
<p>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment</p>
</blockquote>
<p>回车跳转至该位置，然后双击Path进行修改，以及在空白处右键新建字符串值<strong>PY_HOME</strong>，并输入数值数据，数据格式和前文所说方法类似。</p>
<p><a href="#%E9%80%9A%E8%BF%87PY-HOME%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%E5%88%87%E6%8D%A2python%E7%89%88%E6%9C%AC">下一步：通过PY-HOME系统变量切换python版本</a></p>
<h4 id="通过命令行setx命令和reg命令进行设置"><a href="#通过命令行setx命令和reg命令进行设置" class="headerlink" title="通过命令行setx命令和reg命令进行设置"></a>通过命令行setx命令和reg命令进行设置</h4><p>可以通过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setx /?</span><br><span class="line">reg /?</span><br></pre></td></tr></table></figure>

<p>查看使用方法，也可以谷歌其他教程，此处略过。</p>
<h3 id="自动设置系统环境变量"><a href="#自动设置系统环境变量" class="headerlink" title="自动设置系统环境变量"></a>自动设置系统环境变量</h3><p>我也写了一个使用reg和setx命令自动设置python系统环境变量的脚本win_py_syspath_sw_create.bat。</p>
<p>**[注意]**，本脚本会做出以下行为：</p>
<ol>
<li>申请管理员权限</li>
<li>修改系统变量Path并创建系统变量PY_HOME</li>
<li>在Path之前，将查询到的Path变量备份到txt文件内</li>
<li>在Path之前，会自动删除Path中特定的六个路径，<strong>可能和你之前设置的不一样</strong></li>
</ol>
<p>免责声明：</p>
<ol>
<li>本人不对该脚本运行造成的任何后果负责，也不提倡任何人学习使用batch语言</li>
<li>真正的懒人应该参考前面所说的手动设置方法进行设置</li>
</ol>
<p>代码和下载详见<a href="%E5%86%B0%E7%81%B5win%E6%89%B9%E5%A4%84%E7%90%86.html#python%E7%8E%AF%E5%A2%83%E6%89%B9%E5%A4%84%E7%90%86">冰灵win批处理</a>。</p>
<h3 id="通过PY-HOME系统变量切换python版本"><a href="#通过PY-HOME系统变量切换python版本" class="headerlink" title="通过PY_HOME系统变量切换python版本"></a>通过PY_HOME系统变量切换python版本</h3><p>日常使用时修改系统变量PY_HOME的值即可达到切换python环境的目的，注意修改后要记得重启命令行界面或者系统变量界面来载入系统变量的新值。</p>
<p>如果pip的使用出现异常情况，请通过<a target="_blank" rel="noopener" href="https://pip.pypa.io/en/stable/installing/#installing-with-get-pip-py">getpip的方法</a>重装pip。</p>
<h4 id="手动切换python版本"><a href="#手动切换python版本" class="headerlink" title="手动切换python版本"></a>手动切换python版本</h4><p>类似地，<a href="#%E9%80%9A%E8%BF%87%E7%B3%BB%E7%BB%9F%E5%B1%9E%E6%80%A7%E8%AE%BE%E7%BD%AE">通过系统属性设置</a>和<a href="#%E9%80%9A%E8%BF%87%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%BF%9B%E8%A1%8C%E8%AE%BE%E7%BD%AE">通过注册表进行设置</a>都可以修改PY_HOME的值。</p>
<h4 id="自动切换python版本"><a href="#自动切换python版本" class="headerlink" title="自动切换python版本"></a>自动切换python版本</h4><p>我也写了一个使用reg和setx命令自动切换PY_HOME系统环境变量的脚本win_py_syspath_sw.bat。</p>
<p>**[注意]**，本脚本会做出以下行为：</p>
<ol>
<li>申请管理员权限</li>
<li>查询系统变量PY_HOME</li>
<li>根据当前的python版本(只看PY_HOME的后两位数字)切换到另一个，<strong>可能和你之前安装的路径名不一样</strong></li>
<li>两者的默认取值为pyhome_1&#x3D;27和pyhome_2&#x3D;37，你可以根据自己的情况进行修改</li>
</ol>
<p>免责声明：</p>
<ol>
<li>本人不对该脚本运行造成的任何后果负责，也不提倡任何人学习使用batch语言</li>
<li>真正的懒人应该参考前面所说的手动设置方法进行设置</li>
</ol>
<p>代码和下载详见<a href="%E5%86%B0%E7%81%B5win%E6%89%B9%E5%A4%84%E7%90%86.html#python%E7%8E%AF%E5%A2%83%E6%89%B9%E5%A4%84%E7%90%86">冰灵win批处理</a>。</p>
<h3 id="本方法参考"><a href="#本方法参考" class="headerlink" title="本方法参考"></a>本方法参考</h3><p>本方法参考自<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/3701646/how-to-add-to-the-pythonpath-in-windows/21433154#21433154">python - How to add to the pythonpath in Windows? - Stack Overflow</a>。</p>
<p>其他类似的教程<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/av41868809">Python多版本共存配置_哔哩哔哩 (゜-゜)つロ 干杯~-bilibili</a>。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://binglinggroup.github.io/archives/%E5%9C%A8windows%E7%89%88%E7%9A%84sourcetree%E4%B8%8A%E8%AE%BE%E7%BD%AEgpg%E7%AD%BE%E5%90%8D.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="冰灵">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冰灵的博客 | BingLing's Blog">
      <meta itemprop="description" content="冰灵制作组的日志集散地">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 冰灵的博客 | BingLing's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/archives/%E5%9C%A8windows%E7%89%88%E7%9A%84sourcetree%E4%B8%8A%E8%AE%BE%E7%BD%AEgpg%E7%AD%BE%E5%90%8D.html" class="post-title-link" itemprop="url">在windows版的sourcetree上设置gpg签名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-02-01 14:00:00" itemprop="dateCreated datePublished" datetime="2019-02-01T14:00:00Z">2019-02-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-23 04:48:32" itemprop="dateModified" datetime="2024-04-23T04:48:32Z">2024-04-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%BC%94%E7%A4%BA/" itemprop="url" rel="index"><span itemprop="name">演示</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/archives/%E5%9C%A8windows%E7%89%88%E7%9A%84sourcetree%E4%B8%8A%E8%AE%BE%E7%BD%AEgpg%E7%AD%BE%E5%90%8D.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="archives/在windows版的sourcetree上设置gpg签名.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p><a target="_blank" rel="noopener" href="https://ws1.sinaimg.cn/large/b07fd0f8ly1fzqx5qjwv4j21hc0u0b29.jpg">题图来源(Code Lyoko E73的11分50秒位置)</a>将浏览器拉窄即可看到全图。<br>PC版网页左上角从上到下第二个图标是目录，请多用目录。<br>网页右下角按钮为返回顶部，请多用返回顶部来查看顶部目录。</p>
</blockquote>
<p><escape><font size=4>目录</font></escape></p>
<ol>
<li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li>
<li><a href="#%E5%8E%9F%E7%90%86">原理</a></li>
<li><a href="#%E7%A8%8B%E5%BA%8F%E5%87%86%E5%A4%87">程序准备</a><ul>
<li>3.1 <a href="#%E5%AE%89%E8%A3%85Gpg4win">安装Gpg4win</a></li>
<li>3.2 <a href="#%E5%AE%89%E8%A3%85sourcetree">安装sourcetree</a></li>
</ul>
</li>
<li><a href="#%E8%AE%BE%E7%BD%AEGpg4win">设置Gpg4win</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AEgithub">设置github</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AEsourcetree">设置sourcetree</a></li>
<li><a href="#%E7%96%91%E9%9A%BE%E8%A7%A3%E7%AD%94">疑难解答</a></li>
</ol>
<p>本文章主要讲解在使用windows版sourcetree对github commit进行签名操作，本方法主要优点在于可根据不同仓库设置是否使用何种签名，而非全局使用某一特定签名。</p>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>GPG签名是什么？<a target="_blank" rel="noopener" href="https://github.com/longtian/gpg-howto">怎样为你的 Commit 加上 GPG 的签名</a></p>
<blockquote>
<p>为 Commit 带上 GPG 的签名就是一个很好的开始，它能够在一定程度上保证安全性。</p>
</blockquote>
<p>简而言之就是类似账号两步验证之类的确保你的github账号创建的提交(commit)是你本人做出的而不是别人盗用你账号做出的，类似的方法有mega网盘的账户还原密钥。</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2013/07/gpg.html">GPG入门教程 - 阮一峰的网络日志</a></p>
<h3 id="程序准备"><a href="#程序准备" class="headerlink" title="程序准备"></a>程序准备</h3><p>以下程序准备针对的操作系统环境是windows 10，git图形界面则是sourcetree。</p>
<h4 id="安装Gpg4win"><a href="#安装Gpg4win" class="headerlink" title="安装Gpg4win"></a>安装Gpg4win</h4><p><a href="gpg4win_site">Gpg4win - Secure email and file encryption with GnuPG for Windows</a></p>
<h4 id="安装sourcetree"><a href="#安装sourcetree" class="headerlink" title="安装sourcetree"></a>安装sourcetree</h4><p><a target="_blank" rel="noopener" href="https://www.sourcetreeapp.com/">sourcetree</a><br>一些设置建议可以参考[github pull request流程演示之安装sourcetree](github pull request流程演示.html#安装sourcetree)。</p>
<h3 id="设置Gpg4win"><a href="#设置Gpg4win" class="headerlink" title="设置Gpg4win"></a>设置Gpg4win</h3><p>安装的是Gpg4win，此处以Kleopatra为例，同样你也可以使用其他GPG密钥管理界面，密钥管理方法应该是类似的。选择菜单栏-文件-新建密钥对，根据提示自行创建密钥，也可以参考<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2013/07/gpg.html">GPG入门教程 - 阮一峰的网络日志</a>。</p>
<p><strong>注意</strong>， 邮箱账号需为你在github账号中验证过(verified)的邮箱，来源<a target="_blank" rel="noopener" href="https://help.github.com/articles/generating-a-new-gpg-key/#generating-a-gpg-key">Generating a new GPG key - User Documentation</a>，同时第8步中github也给你了隐藏邮箱的方法。</p>
<p>创建完毕后，点击刚才创建的密钥对，右键-细节，公钥就是Kleopatra里面的指纹部分，点击导出获得私钥，你刚才被要求输入的那段密码是用于保护私钥的密码，并不是私钥本身。</p>
<h3 id="设置github"><a href="#设置github" class="headerlink" title="设置github"></a>设置github</h3><p>参考github官方文档<a target="_blank" rel="noopener" href="https://help.github.com/articles/adding-a-new-gpg-key-to-your-github-account/">Adding a new GPG key to your gitHub account - User Documentation</a>，以及官方推荐的设置步骤<a target="_blank" rel="noopener" href="https://help.github.com/articles/about-commit-signature-verification/#gpg-commit-signature-verification">About commit signature verification - User Documentation - gpg</a>。</p>
<p>此处github需要粘贴进去的gpg key指的是在前一个步骤中生成的私钥。</p>
<h3 id="设置sourcetree"><a href="#设置sourcetree" class="headerlink" title="设置sourcetree"></a>设置sourcetree</h3><p>严格意义上这里并不是设置sourcetree，而是设置每个仓库(repository)提交所需的配置文件，位置是：</p>
<blockquote>
<p>仓库文件夹&#x2F;.git&#x2F;config</p>
</blockquote>
<p>全局(global)配置文件在windows当前用户的用户文件夹根目录下：</p>
<blockquote>
<p>C:&#x2F;Users&#x2F;你的用户名&#x2F;.gitconfig</p>
</blockquote>
<p>当然如果你用命令行操作git的话，可以参考git官方文档的local参数说明<a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-config#git-config---local">git - git-config Documentation - local</a>和配置文件读取顺序说明<a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-config#FILES">git - git-config Documentation - files</a>。</p>
<p>根据配置文件读取顺序说明，可以得知git提交(commit)的时候，在不加特定参数时，会先读取全局配置文件(global git config)，然后再读取本地配置文件(local git config)，如果在全局配置文件里面设置了特定用户的gpg签名，而你有多个github用户或者多个gpg签名或者有的仓库不想使用gpg签名的时候，就会出现混乱。</p>
<p>本篇文章原创部分最大的地方也就在这里<del>换句话说其他地方都是抄的</del>，之前我参照的一个教程<a target="_blank" rel="noopener" href="https://xiaoxi654.me/2018/12/28/%E5%A6%82%E4%BD%95%E5%9C%A8Windows%E7%89%88%E7%9A%84Sourcetree%E4%B8%8A%E5%90%AF%E7%94%A8GPG%E7%AD%BE%E5%90%8D/">在Windows版的Sourcetree上启用GPG签名</a>只说了全局的方法，但是如上所述会出现混乱的情况，所以我这里给出的方法是不在全局配置文件处进行设置。而是对每个仓库的配置文件进行设置，设置方法和全局配置文件的写法一样，添加以下字段即可。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span>user<span class="punctuation">]</span></span><br><span class="line">    name =</span><br><span class="line"># name指gpg签名生成时你填的名字</span><br><span class="line">    email =</span><br><span class="line"># email指gpg签名生成时你填的邮箱</span><br><span class="line">    signingkey =</span><br><span class="line"># signingkey指公钥ID的后八位，或者说指纹的后八位</span><br><span class="line"><span class="punctuation">[</span>commit<span class="punctuation">]</span></span><br><span class="line">    gpgSign = <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"># 此处gpgSign的值可为<span class="literal"><span class="keyword">true</span></span>或者<span class="literal"><span class="keyword">false</span></span>，<span class="literal"><span class="keyword">true</span></span>指开启gpg签名</span><br><span class="line"><span class="punctuation">[</span>gpg<span class="punctuation">]</span></span><br><span class="line">    program = c<span class="punctuation">:</span>\\Program Files (x86)\\GnuPG\\bin\\gpg.exe</span><br><span class="line"># 这里program的位置是Gpg4win安装时的默认位置</span><br><span class="line"># 如果你当时没装在这个路径，请自行修改</span><br><span class="line"># 注意两条反斜线中一条是用来转义的，务必确保路径名中的反斜线是有两条的</span><br></pre></td></tr></table></figure>

<p>这样设置好了以后，再提交的时候，git就会调用gpg，要求你对提交进行签名，此时你需要输入那串用于保护私钥的密码。</p>
<h3 id="疑难解答"><a href="#疑难解答" class="headerlink" title="疑难解答"></a>疑难解答</h3><p>前面所讲都是让sourcetree使用内嵌的git的情况下进行的操作，因为sourcetree使用oauth绑定多个github账号时的[各种问题](github pull request流程演示.html#推送-push-你刚才的提交-commit)，所以没怎么试过用外部git单独操作的情况是否能成功设置。理论上这套教程也可以用于单独安装的git，<del>毕竟以上各种玄学问题的解释都是从git的官方文档里找的</del>，我本人尝试的结果是可以用于强制推送的指令，其他还没试过。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://binglinggroup.github.io/archives/github%20pull%20request%E6%B5%81%E7%A8%8B%E6%BC%94%E7%A4%BA.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="冰灵">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冰灵的博客 | BingLing's Blog">
      <meta itemprop="description" content="冰灵制作组的日志集散地">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 冰灵的博客 | BingLing's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/archives/github%20pull%20request%E6%B5%81%E7%A8%8B%E6%BC%94%E7%A4%BA.html" class="post-title-link" itemprop="url">github pull request流程演示</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-02-01 09:00:00" itemprop="dateCreated datePublished" datetime="2019-02-01T09:00:00Z">2019-02-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-23 05:47:34" itemprop="dateModified" datetime="2024-04-23T05:47:34Z">2024-04-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%BC%94%E7%A4%BA/" itemprop="url" rel="index"><span itemprop="name">演示</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/archives/github%20pull%20request%E6%B5%81%E7%A8%8B%E6%BC%94%E7%A4%BA.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="archives/github pull request流程演示.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/BingLingGroup/BingLingGroup.github.io/img/github%20pull%20request%E6%B5%81%E7%A8%8B%E6%BC%94%E7%A4%BA/b07fd0f8ly1fyvvhry8scj21hc0u0hcw.jpg">题图来源(Code Lyoko E72的07分17秒位置)</a>将浏览器拉窄即可看到全图。<br>PC版网页左上角从上到下第二个图标是目录，请多用目录。<br>网页右下角按钮为返回顶部，请多用返回顶部来查看顶部目录。</p>
</blockquote>
<p><escape><font size=4>目录</font></escape></p>
<ol>
<li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li>
<li><a href="#%E7%A8%8B%E5%BA%8F%E5%87%86%E5%A4%87">程序准备</a><ul>
<li>2.1 <a href="#%E5%AE%89%E8%A3%85sourcetree">安装sourcetree</a></li>
<li>2.2 <a href="#%E5%AE%89%E8%A3%85git">安装git</a></li>
</ul>
</li>
<li><a href="#pull-request%E6%B5%81%E7%A8%8B">pull request流程</a><ul>
<li>3.1 <a href="#%E8%BF%9C%E7%A8%8B%E5%85%8B%E9%9A%86-fork-%E4%BB%96%E4%BA%BA%E4%BB%93%E5%BA%93">远程克隆(fork)他人仓库</a></li>
<li>3.2 <a href="#%E5%85%8B%E9%9A%86-clone-%E4%BD%A0%E5%88%9A%E5%88%9B%E5%BB%BA%E7%9A%84%E5%89%AF%E6%9C%AC%E5%B9%B6%E4%BF%AE%E6%94%B9%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6">克隆(clone)你刚创建的副本并修改本地文件</a></li>
<li>3.3 <a href="#%E6%8F%90%E4%BA%A4-commit-%E4%BD%A0%E5%88%9A%E6%89%8D%E8%BF%9B%E8%A1%8C%E7%9A%84%E6%94%B9%E5%8A%A8">提交(commit)你刚才进行的改动</a></li>
<li>3.4 <a href="#%E6%8E%A8%E9%80%81-push-%E4%BD%A0%E5%88%9A%E6%89%8D%E7%9A%84%E6%8F%90%E4%BA%A4-commit">推送(push)你刚才的提交(commit)</a></li>
<li>3.5 <a href="#%E6%88%91%E6%83%B3%E5%8F%8D%E6%82%94%E6%8E%A8%E9%80%81-push-%E6%80%8E%E4%B9%88%E5%8A%9E">我想反悔推送(push)怎么办</a></li>
</ul>
</li>
</ol>
<p>本教程面向会使用谷歌的github零基础使用者，同时也作为刚入门github pull request的笔者的简单记录。</p>
<p><escape><div title="就是搜不到这种操作.jpg" align="middle"><img src="https://raw.githubusercontent.com/BingLingGroup/BingLingGroup.github.io/img/github%20pull%20request%E6%B5%81%E7%A8%8B%E6%BC%94%E7%A4%BA/你不会搜索吗.jpg" height="60%" width="60%"></div></escape><br><escape><div align="middle">就是搜不到这种操作.jpg</div></escape></p>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>pull request是什么？<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2017/07/pull_request.html">Pull Request 的命令行管理 - 阮一峰的网络日志</a></p>
<blockquote>
<p>“Pull Request 是一种通知机制。你修改了他人的代码，将你的修改通知原来的作者，希望他合并你的修改，这就是 Pull Request。”</p>
</blockquote>
<p>直接翻译过来可以理解为拉取(pull)请求(request)。推送(push)和拉取(pull)是github多种基本操作之一，推送一般指将本地git仓库的特定分支(branch)推送到远程仓库(譬如github的某个repository)的特定分支(也称remote branch)，pull则是相反的操作。之所以称作是拉取请求，我个人的理解是你对别人的仓库里一个分支的文件进行了改动，向别人发起请求来拉取你一个分支里的改动，只不过这里的拉取是远程到远程的操作，都是github上的仓库而和本地没有关系。</p>
<h3 id="程序准备"><a href="#程序准备" class="headerlink" title="程序准备"></a>程序准备</h3><p>以下安装准备针对的操作系统环境是windows 10，git图形界面则是sourcetree，部分sourcetree不能解决的问题会涉及到git Bash操作。</p>
<p><a href="#pull-request%E6%B5%81%E7%A8%8B">返回pull request流程</a></p>
<h4 id="安装sourcetree"><a href="#安装sourcetree" class="headerlink" title="安装sourcetree"></a>安装sourcetree</h4><p><a target="_blank" rel="noopener" href="https://www.sourcetreeapp.com/">sourcetree</a>是一个并不那么省心的git图形界面软件，但是git图形界面软件就那么几个，只能将就着用了，不然就命令行吧。</p>
<p>安装时建议使用内嵌(Embedded)版git，内嵌版git在添加多个github账号时使用起来较为繁琐，但是sourcetree使用外部git时<em>好像</em>(此处存疑)无法使用oauth一键绑定github账号，也要注意全局git config(位置一般在&#x2F;Users&#x2F;你的用户名&#x2F;.gitconfig)中的用户设置，总之我印象里面是有bug。相比之下单独使用git配置多账户的教程可以参考<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/89cb26e5c3e8">同一客户端下使用多个git账号 - 简书</a>。如果要使用系统自带的git，请自行安装git。<del>其他问题包括如何使用sourcetree，如何在sourcetree中登录github账号等，就自己谷歌吧，这里略去</del></p>
<h4 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装git</h4><p>安装git之前我建议先安装一个windows的第三方包管理器<a target="_blank" rel="noopener" href="https://chocolatey.org/docs/installation">chocolatey</a>，因为chocolatey可以自动帮你维护环境变量-系统变量，同时还能帮你更新软件，使用起来更加安心。chocolatey的使用范例可以参考<a target="_blank" rel="noopener" href="https://blessing.studio/use-ffmpeg-to-concat-flv-videos-downloaded-by-bilibili-client/">使用 ffmpeg 拼接 bilibili 客户端所下载的分段 flv 视频</a>。</p>
<p>安装好chocolatey之后，用管理员权限运行命令行或者Powershell(譬如Win+X调出快捷键菜单运行)，输入以下指令来安装git。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install git -y</span><br></pre></td></tr></table></figure>

<h3 id="pull-request流程"><a href="#pull-request流程" class="headerlink" title="pull request流程"></a>pull request流程</h3><p>pull request需要的流程主要是先远程克隆(<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/20431718">fork</a>)他人的仓库，然后克隆(clone)到本地，接着在本地，对文件进行修改(modify)，修改之后，提交(commit)并推送(push)到你远程的分支(branch)上。再打开别人的项目主页，点击中间的New pull request建立新的拉取请求，可以看到一个对比页面，选择好了之后填写说明创建(Create pull request)即可。具体参考<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2017/07/pull_request.html">Pull Request 的命令行管理 - 阮一峰的网络日志</a>，这里不再赘述。</p>
<p>以下是遵循<a href="#%E7%A8%8B%E5%BA%8F%E5%87%86%E5%A4%87">上述环境</a>下进行操作的一部分提示。</p>
<h4 id="远程克隆-fork-他人仓库"><a href="#远程克隆-fork-他人仓库" class="headerlink" title="远程克隆(fork)他人仓库"></a>远程克隆(fork)他人仓库</h4><p>打开他人的仓库(repository)主页，你会看到右上角有一个Fork按钮，点击Fork，创建他人仓库在你github账号下的副本。</p>
<h4 id="克隆-clone-你刚创建的副本并修改本地文件"><a href="#克隆-clone-你刚创建的副本并修改本地文件" class="headerlink" title="克隆(clone)你刚创建的副本并修改本地文件"></a>克隆(clone)你刚创建的副本并修改本地文件</h4><p>打开sourcetree，点击Clone，克隆你刚才创建的远端仓库副本，然后在本地修改文件。</p>
<h4 id="提交-commit-你刚才进行的改动"><a href="#提交-commit-你刚才进行的改动" class="headerlink" title="提交(commit)你刚才进行的改动"></a>提交(commit)你刚才进行的改动</h4><p>这里面有两个坑，我先说明一下。</p>
<p>首先，注意<a target="_blank" rel="noopener" href="https://github.com/cssmagic/blog/issues/22">关闭换行符自动转换</a>，如果你使用那种一旦将CRLF转换成LF就会影响代码运行或者其他严重后果的编程语言或者集成开发环境(如Batch，Vivado verilog等)，请务必关闭这一选项。其他情况也请酌情关闭。<del>LF虽好，可我大窗国自有国情在此，原不藉外夷货物以通有无</del></p>
<p>其次，注意你要pull request的仓库是否开启了提交验证(commit verified)。</p>
<p><escape><div title="提交验证的后台设置位置，当然只有权限狗才能看得到_1.jpg" align="middle"><img src="https://raw.githubusercontent.com/BingLingGroup/BingLingGroup.github.io/img/github%20pull%20request%E6%B5%81%E7%A8%8B%E6%BC%94%E7%A4%BA/%E6%8F%90%E4%BA%A4%E9%AA%8C%E8%AF%81-1.png" height="70%" width="70%"></div></escape></p>
<p><escape><div title="提交验证的后台设置位置，当然只有权限狗才能看得到_2.jpg" align="middle"><img src="https://raw.githubusercontent.com/BingLingGroup/BingLingGroup.github.io/img/github%20pull%20request%E6%B5%81%E7%A8%8B%E6%BC%94%E7%A4%BA/%E6%8F%90%E4%BA%A4%E9%AA%8C%E8%AF%81-2.png" height="50%" width="50%"></div></escape></p>
<p><del>不是这两张</del>，应该是下面这些。</p>
<p>譬如仓库的readme里面或者contribute文档里面明确说明pull request需要签名验证<del>此处懒得找图了</del>。</p>
<p>打开某个pull request后看到有人因为没有提交验证<del>而格格不入</del>。</p>
<p><escape><div title="没有提交验证而格格不入.jpg" align="middle"><img src="https://raw.githubusercontent.com/BingLingGroup/BingLingGroup.github.io/img/github%20pull%20request%E6%B5%81%E7%A8%8B%E6%BC%94%E7%A4%BA/%E6%8F%90%E4%BA%A4%E9%AA%8C%E8%AF%81-3.png" height="80%" width="80%"></div></escape></p>
<p>或者打开提交历史(在仓库主页点击commits即可看到)，最近的提交都有签名。</p>
<p><escape><div title="一列漂亮的小绿标.jpg" align="middle"><img src="https://raw.githubusercontent.com/BingLingGroup/BingLingGroup.github.io/img/github%20pull%20request%E6%B5%81%E7%A8%8B%E6%BC%94%E7%A4%BA/%E6%8F%90%E4%BA%A4%E9%AA%8C%E8%AF%81-4.png" height="80%" width="80%"></div></escape></p>
<p>关于<escape><a name = "签名验证" href="#签名验证">签名验证</a></escape>的具体操作方法，可以参考我写的另一篇文章<a href="%E5%9C%A8windows%E7%89%88%E7%9A%84sourcetree%E4%B8%8A%E8%AE%BE%E7%BD%AEgpg%E7%AD%BE%E5%90%8D.html">在windows版的sourcetree上设置gpg签名</a>。</p>
<p>如果你已经创建了pull request，忘记或者不清楚对提交进行签名，却被要求要进行签名<del>被格格不入</del>的时候，这时可以通过现在本地软重置提交再强制推送的方式更改掉你之前没有签名的分支，详见<a href="#%E6%88%91%E6%83%B3%E5%8F%8D%E6%82%94%E6%8E%A8%E9%80%81-push-%E6%80%8E%E4%B9%88%E5%8A%9E">反悔推送</a>的方法。注意你在强制推送之前，请务必先在本地做好带gpg签名的提交。</p>
<h4 id="推送-push-你刚才的提交-commit"><a href="#推送-push-你刚才的提交-commit" class="headerlink" title="推送(push)你刚才的提交(commit)"></a>推送(push)你刚才的提交(commit)</h4><p>这里也有两个坑。</p>
<p>首先是sourcetree的问题。如果你在sourcetree里面绑定了多个github账号，提交能成功，却发现推送总是失败的时候，注意在工具-选项-验证-账户里，把当前仓库的账号设置成默认账号即可解决问题，原因是sourcetree对多个github账号的oauth验证管理有缺陷，似乎不能针对单个仓库进行账户密码管理。或者你也可以请<a target="_blank" rel="noopener" href="https://blog.csdn.net/tengdazhang770960436/article/details/54171911">自行配置</a>ssh而不使用sourcetree的oauth验证，这样其实就和命令行git的配置使用差不多了。<del>这样的话真的感觉sourcetree有个GUI用</del></p>
<p>其次是如果有人有整洁强迫症，可以考虑在推送时推送到一个单独的分支上，而不是推送到副本分支上，譬如你可以单独新建一个patch-xxx这样的分支等等，具体请谷歌。反正合并的时候自己知道用哪个分支合并就可以了，命名规范主要是记录起来好看一点。</p>
<h4 id="我想反悔推送-push-怎么办"><a href="#我想反悔推送-push-怎么办" class="headerlink" title="我想反悔推送(push)怎么办"></a>我想反悔推送(push)怎么办</h4><p>假如你推送了一个错误的东西上去，再纠正还得再推一个，感觉没必要的时候，可以使用这个方法。</p>
<p>在sourcetree里，点击你要重置回去的那一次提交，右键-重置当前分支到此次提交-软合并(保留所有本地改动)，确定你做的修改没问题后，再正常地在本地提交一次，提交完了之后，确定本地仓库没问题的时候，右上角点击命令行模式，打开git bash，输入以下指令即可。参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/ligang2585116/article/details/71094887">git撤销&amp;回滚操作 - 李刚的学习专栏 - CSDN博客</a>。</p>
<p>注意尽量只在自己的仓库上进行强制推送，强制推送过于暴力，可能会造成一些不可挽回的后果。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -f</span><br></pre></td></tr></table></figure>

<p>返回<escape><a href="#签名验证">签名验证</a></escape></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://binglinggroup.github.io/archives/%E5%86%B0%E7%81%B5win%E6%89%B9%E5%A4%84%E7%90%86.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="冰灵">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冰灵的博客 | BingLing's Blog">
      <meta itemprop="description" content="冰灵制作组的日志集散地">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 冰灵的博客 | BingLing's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/archives/%E5%86%B0%E7%81%B5win%E6%89%B9%E5%A4%84%E7%90%86.html" class="post-title-link" itemprop="url">冰灵win批处理(190209)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-01-05 18:00:00" itemprop="dateCreated datePublished" datetime="2019-01-05T18:00:00Z">2019-01-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-23 04:48:32" itemprop="dateModified" datetime="2024-04-23T04:48:32Z">2024-04-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">工具</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/archives/%E5%86%B0%E7%81%B5win%E6%89%B9%E5%A4%84%E7%90%86.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="archives/冰灵win批处理.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/BingLingGroup/BingLingGroup.github.io/img/%E5%86%B0%E7%81%B5win%E6%89%B9%E5%A4%84%E7%90%86/[Crappy%201080P]%20Code%20Lyoko%20S4E80_001148.878.png">题图来源(Code Lyoko E80的11分48秒位置)</a>将浏览器拉窄即可看到全图。<br>PC版网页左上角从上到下第二个图标是目录，请多用目录。<br>标题后面括号里的日期指的是最后更新日期，头像旁边的日期是最初发布日期。</p>
</blockquote>
<p><escape><font size=4>目录</font></escape></p>
<ol>
<li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li>
<li><a href="#%E6%89%B9%E9%87%8F%E9%87%8D%E5%91%BD%E5%90%8D%E6%89%B9%E5%A4%84%E7%90%86-rename-files-from-txt">批量重命名批处理</a><ul>
<li>2.1 <a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%86%99%E8%BF%99%E6%A0%B7%E4%B8%80%E4%B8%AA%E6%89%B9%E5%A4%84%E7%90%86">为什么要写这样一个批处理</a></li>
<li>2.2 <a href="#%E5%8A%9F%E8%83%BD">功能</a></li>
<li>2.3 <a href="#%E4%BD%BF%E7%94%A8">使用</a></li>
</ul>
</li>
<li><a href="#%E6%89%B9%E9%87%8F%E5%8E%8B%E7%BC%A9%E6%89%B9%E5%A4%84%E7%90%86-7z-batch%E5%92%8Crun-7z-batch">批量压缩批处理</a></li>
<li><a href="#python%E7%8E%AF%E5%A2%83%E6%89%B9%E5%A4%84%E7%90%86">python环境批处理</a></li>
<li><a href="#%E5%85%B6%E4%BB%96%E6%89%B9%E5%A4%84%E7%90%86">其他批处理</a></li>
</ol>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>这次来讲讲最近为了发布资源而写的几个windows batch批处理的使用指南。注意只能在windows上使用，<del>谁叫batch是windows专用的脚本语言，只能被windows命令行解释器执行，但是写起来一点也不省心啊</del>，以后大概会出同功能的python版，这样就可以跨平台运行了。</p>
<p>冰灵批处理相关的<a target="_blank" rel="noopener" href="https://github.com/BingLingGroup/bingling-batch">github仓库</a>，可以通过下载<a target="_blank" rel="noopener" href="https://github.com/BingLingGroup/bingling-batch/archive/dev.zip">仓库压缩文档</a>获得可以直接在windows上运行的.bat文件。目前项目readme还在施工中，<del>因为我懒</del>。</p>
<p>特别要注意的一点是，和其他命令行软件的输入一样，如果你的路径或者文件名里面有空格，那么请务必在外面加上引号。</p>
<h3 id="批量重命名批处理-rename-files-from-txt"><a href="#批量重命名批处理-rename-files-from-txt" class="headerlink" title="批量重命名批处理(rename_files_from_txt)"></a>批量重命名批处理(rename_files_from_txt)</h3><h4 id="为什么要写这样一个批处理"><a href="#为什么要写这样一个批处理" class="headerlink" title="为什么要写这样一个批处理"></a>为什么要写这样一个批处理</h4><p>其实很多软件都有批量重命名的功能，我平时用的<a target="_blank" rel="noopener" href="http://www.xiles.net/">nexus file</a>在这方面功能就极其强大，譬如可以控制插入字符的位置，查找替换等等，那我为什么还要写这样一个批处理呢？</p>
<p>实际上，这些重命名软件，我现在还没看到哪个是支持全自定义列表重命名的，也就是，每一个文件名的内容都不一样，那有人问了，你既然每一个文件名内容都不一样，为什么不能一个个重命名非要写一个程序呢？其实这里是有一个相对合理的应用场景的。</p>
<ol>
<li>一个个重命名，就不说鼠标要一个个点浪费<del>微动</del>寿命了，F2键也会被摁坏，甚至不知道快捷键的人可能会摁坏第二个鼠标按键(冷笑话)。</li>
<li>考虑一下是别人给你的文件名列表呢？那你可能还要多坏另外三个键盘的按键是Ctrl，C和V了(滑稽)</li>
</ol>
<p>我就说说冰灵的应用场景。</p>
<ol>
<li>字幕组组长给你拟定了一个分集标题，每集标题都不一样。</li>
<li>你是负责把视频上传到b站的，b站的分P名和很多网站处理上传文件的逻辑是一样的，默认值是上传前的文件名。(a站就不是 <del>所以a站就不填分P名了</del>)</li>
<li>b站的分P名编辑起来比较鬼畜，好像是不能用鼠标点光标位置，修改起来困难。</li>
<li>你会很自然想到先在本地就把文件名重命名好然后再上传。</li>
</ol>
<p>譬如这样一个列表，一行一个名称</p>
<blockquote>
<p>S4E66_William Returns_William回归<br>S4E67_Double Take_替身袭击<br>S4E68_Opening Act_开幕演出<br>S4E69_Wreck Room_毁坏房间<br>……</p>
</blockquote>
<p>那也就会很自然地想到写一个程序一行行读进来然后拿去重命名。</p>
<p>至于为什么用的批处理，<del>主要是看到一个<a target="_blank" rel="noopener" href="https://space.bilibili.com/3512816">b站压制大佬</a>写的用来转换帧率的批处理不够懒人化而感到不满于是开始入坑</del>，一开始是想着写着简单，后来发现越简单的东西越难写，特别是batch的中文文档不是很多<del>很难抄代码</del>的情况下，还好后来多看<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands">官方文档</a>和stackoverflow解决了一部分问题。</p>
<h4 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h4><p>目前能做到的功能就是从一个源文件名txt和一个目的文件名txt中读取文件名，然后改名。其中源文件名txt支持自动生成，但是因为batch默认的文件名排序比较迷，和资源管理器中的文件名顺序并不一致。</p>
<p>最明显的一点是，按文件名顺序排序后，资源管理器里面1后面的2到9的数字会在10之前，而batch的文件名顺序是，2到9的数字会在10之后，只有你命名成等宽的数字编码，譬如最大不超过999则是001或者最大不超过99则是01这种，才会得到正确的排序。</p>
<p>所以本批处理会强制停下让你重新检查源文件名列表和目的文件名列表的一一对应关系，如果有问题建议复制到<a target="_blank" rel="noopener" href="https://www.libreoffice.org/">excel</a>中进行编辑，只要在这个步骤时，确认每一行对应关系没问题，那么最后重命名的结果就是正确的，毕竟程序核心只是遍历每一行txt，然后调用系统自带的重命名命令ren进行重命名而已。<del>毕竟batch太过简略，拿来写排序算法也实在太难受所以后续估计不会在这方面进行改进了</del>。</p>
<blockquote>
<p>什么？你电脑上还没有装excel？<a target="_blank" rel="noopener" href="https://www.libreoffice.org/">libre office</a>了解一下，如果不是给老师写报告，只是搞搞重命名应该够用了，还没有WPS的弹窗😨</p>
</blockquote>
<p>以及，因为<a target="_blank" rel="noopener" href="https://www.libreoffice.org/">excel</a>或者<a target="_blank" rel="noopener" href="http://www.xiles.net/">nexus file</a>这类软件对于编号式重命名方面的功能非常强大，本批处理以后也不会在这方面增加功能。</p>
<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>直接打开后会弹出全提示模式，使用方法详见提示信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">echo ^[警告^]这里若不退出，下一步将进行重命名</span><br><span class="line">echo 请确认已做好文件备份，以防止意外情况发生</span><br><span class="line">echo.</span><br><span class="line">echo ^[警告^]请确保不要使用任何windows</span><br><span class="line">echo 文件系统禁止使用的符号进行重命名</span><br><span class="line">echo.</span><br><span class="line">echo 全提示模式：</span><br><span class="line">echo.</span><br><span class="line">echo 1.待改名文件在当前路径下的work文件夹内</span><br><span class="line">echo.</span><br><span class="line">echo 2.work文件夹内所有文件都会被重命名</span><br><span class="line">echo.</span><br><span class="line">echo 3.改名后文件名列表dst_list.txt处在当前路径下，</span><br><span class="line">echo   请使用GB2312编码txt，否则会有乱码</span><br><span class="line">echo   (我大窗国自有窗国情在此)</span><br><span class="line">echo.</span><br><span class="line">echo 4.dst_list.txt的文件名列表格式为：</span><br><span class="line">echo   1)一行一个文件名</span><br><span class="line">echo   2)顺序不影响重命名</span><br><span class="line">echo   3)文件名中可以包含空格</span><br><span class="line">echo.</span><br><span class="line">echo 5.输出这段提示信息前，</span><br><span class="line">echo   如果你的work文件夹已存在，</span><br><span class="line">echo   批处理已将其中的文件名输出成列表</span><br><span class="line">echo   到当前路径下的src_list.txt中</span><br><span class="line">echo.</span><br><span class="line">echo 6.请根据自己喜好创建dst_list.txt，</span><br><span class="line">echo   因为下一步程序</span><br><span class="line">echo   1) 不会再改变dst_list.txt</span><br><span class="line">echo   2) 根据src_list.txt和dst_list.txt进行重命名</span><br><span class="line">echo      如果你有特殊需要，可以对src_list.txt中的文件名</span><br><span class="line">echo      进行编辑操作</span><br><span class="line">echo.</span><br><span class="line">echo 7.不会提示给予再次确认改名前后名称对应关系，</span><br><span class="line">echo   改名前请做好文件备份，以免出现意外情况</span><br><span class="line">echo.</span><br><span class="line">echo 8.建议使用excel提前编辑好改名后文件名</span><br><span class="line">echo   并拷贝到dst_list.txt中</span><br><span class="line">echo   注意使用Ctrl-H搜索替换掉excel特有大空格</span><br><span class="line">echo.</span><br><span class="line">echo 9.不会更改扩展名</span><br><span class="line">echo.</span><br><span class="line">echo 10.如果你做好了1-4的准备，再重新运行本批处理</span><br><span class="line">echo    将会进入到另一个重命名模式</span><br><span class="line">echo.</span><br><span class="line">echo 11.重命名之后</span><br><span class="line">echo    src_list.txt和dst_list.txt不会自动删除</span><br></pre></td></tr></table></figure>

<p>另一种模式其实跟这个差不多，但是会“自动”帮你把dst_list.txt进行排序，未必是好事，后续会改进这个逻辑。提示信息如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">echo ^[警告^]这里若不退出，下一步将进行重命名</span><br><span class="line">echo 请确认已做好文件备份，以防止意外情况发生</span><br><span class="line">echo.</span><br><span class="line">echo ^[警告^]请确保不要使用任何windows</span><br><span class="line">echo 文件系统禁止使用的符号进行重命名</span><br><span class="line">echo.</span><br><span class="line">echo 核对模式：</span><br><span class="line">echo.</span><br><span class="line">echo 1.为了防止你的排序方法</span><br><span class="line">echo   和batch文件名顺序有不一致情况，</span><br><span class="line">echo   已对新文件名列表</span><br><span class="line">echo   按照文件名的顺序重新进行排序，</span><br><span class="line">echo   但是这不代表两种文件顺序</span><br><span class="line">echo   就一定一一对应</span><br><span class="line">echo.</span><br><span class="line">echo 2.^[警告^]如果新旧文件名差异较大，</span><br><span class="line">echo   建议逐行核对</span><br><span class="line">echo.</span><br><span class="line">echo 3.下一步程序</span><br><span class="line">echo   1) 不会再改变dst_list.txt</span><br><span class="line">echo   2) 根据src_list.txt和dst_list.txt进行重命名</span><br><span class="line">echo      如果你有特殊需要，可以对src_list.txt中的文件名</span><br><span class="line">echo      进行编辑操作</span><br><span class="line">echo.</span><br><span class="line">echo 4.重命名之后</span><br><span class="line">echo    src_list.txt和dst_list.txt不会自动删除</span><br></pre></td></tr></table></figure>

<h3 id="批量压缩批处理-7z-batch和run-7z-batch"><a href="#批量压缩批处理-7z-batch和run-7z-batch" class="headerlink" title="批量压缩批处理(7z_batch和run_7z_batch)"></a>批量压缩批处理(7z_batch和run_7z_batch)</h3><p>这个批处理其实意义不大，正常的用途中绝不会有人想到要让每个文件都只打包成一个文件，多数情况下大家都是为了避免小文件传输影响速度或者便捷性才会使用压缩把多个文件打包成一个大压缩包，而且对于有损视频格式而言，使用压缩算法可以再压缩出的空间微乎其微，打成一个大的压缩包会因为体积太大，而不利于大家下载，完全就是做重复计算浪费性能和电费。</p>
<p>做这样的批处理完全是迫于百度云对特定文件格式的检测，规避百度云的所谓检测删封的同时方便大家索取单个视频文件而已。</p>
<p>这个程序其实本来可以写的挺简单的，主要是考虑到要设置一些需要忽略的情况，譬如如果用户非要在待压缩文件所在文件夹里面启动批处理进行压缩，但又不想进行多余的操作，把批处理自身也压缩，产生不必要的文件，那么就需要设置忽略的脚本名称。</p>
<p>其实这个批处理的提示信息也写得挺详细的了，看提示信息基本就会用了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">echo 本批处理可以将某一文件夹内的文件逐个压缩</span><br><span class="line">echo.</span><br><span class="line">echo 首先确认命令行7z，也就是7z.exe是否添加到环境变量-系统变量</span><br><span class="line">echo 或者确认7z.exe在待压缩文件所在文件夹</span><br><span class="line">echo.</span><br><span class="line">echo 输入待压缩的文件所在文件夹</span><br><span class="line">set /p work_dir=(默认为当前文件夹，回车为默认):</span><br><span class="line">echo.</span><br><span class="line">if not defined work_dir set work_dir=%~dp0</span><br><span class="line"></span><br><span class="line">echo 输入压缩后的压缩格式后缀(包括点)</span><br><span class="line">set /p dst_exte=(默认为.7z，请输入7z支持的压缩格式，回车为默认):</span><br></pre></td></tr></table></figure>

<p>还有一个run_7z_batch，是我考虑到这个程序一定要有自定义输入，但是如果由程序提问等待用户输入这样太麻烦了，等于是我每次都要重新输入参数，run_7z_batch就是在命令行界面下调用7z_batch，将参数直接传递给7z_batch，这样7z_batch就不提问了，直接运行更加省事。</p>
<p>因为run_7z_batch是使用call命令调用7z_batch运行，我没查到批处理能获得到call它的批处理或者程序的名称的功能，所以这多设置了一个参数，传递给7z_batch，告诉它run_7z_batch的名字是什么，这样来忽略额外的文件名。还有就是，我在7z_batch里面也把对自身文件名的获取设置成从命令行参数中得到，这样的话就对用户更改了批处理文件名的情况做出了处理。换句话说，你在使用这两个批处理的时候，可以把它们的名字命名成任意你喜欢的名字，也不会影响程序对文件的正常压缩过程，虽然我觉得很没有必要就是了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set z7_bat_name=&quot;7z_batch.bat&quot;</span><br><span class="line">rem 7z_batch文件名</span><br><span class="line">set work_path=&quot;C:\userfile\Desktop\压制\batch脚本\test\work&quot;</span><br><span class="line">rem 待压缩文件所在文件夹，即工作文件夹</span><br><span class="line">set run_bat_name=&quot;run_7z_batch.bat&quot;</span><br><span class="line">rem 需要额外忽略的一个文件名，若此脚本在工作文件夹内，则需要忽略</span><br></pre></td></tr></table></figure>

<h3 id="python环境批处理"><a href="#python环境批处理" class="headerlink" title="python环境批处理"></a>python环境批处理</h3><p>github链接：<a target="_blank" rel="noopener" href="https://github.com/BingLingGroup/bingling-batch/tree/dev/python_syspath_batch">bingling batch python syspath</a></p>
<p>其中win_py_syspath_sw_create.bat为python环境切换创建批处理，win_py_syspath_sw.bat为python环境切换批处理，win_py_syspath_query.bat为系统环境变量查询批处理。</p>
<p>该批处理编写时用到的参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/haibo19981/article/details/52251945">bat知识点3_for循环_跳出嵌套 - haibo19981的专栏 - CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jb51.net/article/17928.htm">批处理 FOR参数&#x2F;F之tokens详解_DOS&#x2F;BAT_脚本之家</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/21606419/set-windows-environment-variables-with-a-batch-file">Set windows environment variables with a batch file - Stack Overflow</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wzsbll/article/details/6690895">如何在cmd命令行中查看、修改、删除与添加环境变量 - wzsbll的专栏 - CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/baiyibin0530/article/details/78841653">SET和SETX命令的应用 - baiyibin0530的专栏 - CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/anhuidelinger/article/details/14044653">通过注册表设置环境变量 - anhuidelinger的专栏 - CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/jinzhenshui/archive/2012/05/17/2506129.html">bat、cmd 批处理中（或 DOS环境）的特殊字符 - jinzhenshui - 博客园</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/35477290/how-to-get-last-n-tokens-from-string-using-for-f-in-batch-file">cmd - How to get last n tokens from string using “FOR &#x2F;F” in batch file - Stack Overflow</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/kukou/article/details/4895676">批处理：FOR的参数&#x2F;F之delims详解 - kukou的专栏 - CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/17327512/printing-all-tokens-after-2nd-token-in-a-batch-script">regex - printing all tokens after 2nd token in a batch script - Stack Overflow</a></p>
<p><a target="_blank" rel="noopener" href="https://alizf.iteye.com/blog/616388">在BAT文件中实现对空格分割的字符串的处理 - zhifeng - ITeye博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/albertsh/article/details/79919465">.bat批处理（六）：替换字符串中匹配的子串 - AlbertS Home of Technology - CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/2772456/string-replacement-in-batch-file/2772498">command line - String replacement in batch file - Stack Overflow</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/41323488/batch-replacing-with-percent-symbol">string - Batch - replacing with percent symbol - Stack Overflow</a></p>
<h3 id="其他批处理"><a href="#其他批处理" class="headerlink" title="其他批处理"></a>其他批处理</h3><p>一个是getname_batch还有一个是test_rename_batch，前面的看到代码中的注释就知道是怎么用的了，后面这个是用来测试rename_batch的批量生成txt的批处理，没必要拿来用我就没加任何注释，但是稍微懂一点batch应该也可以看懂，这里就不再解释了。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/10/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/12/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">冰灵</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"https-binglinggroup-github-io","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script>

</body>
</html>
